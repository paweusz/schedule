"use strict"

define(["domain"], function(domain) {

  var createSchedule = function(id) {

    var weekdays = <%- weekdays %>;
    var timeslots = <%- timeslots %>;
    var subjects = <%- subjects %>;
    var lessons = <%- lessons %>;
    
    var weekdaysColl = new domain.Weekdays(weekdays);
    var timeslotsColl = new domain.Timeslots(_.map(timeslots, function(timeslotTO) {
      return {
        id: timeslotTO.id,
        start: new Date(timeslotTO.start),
        end: new Date(timeslotTO.end)
      }
    }));
    var subjectsColl = new domain.Subjects(subjects);
    var lessonsColl =  new domain.Lessons(_.map(lessons, function(lessonTO) {
      return new domain.Lesson({
        id: lessonTO.id,
        timeslot: timeslotsColl.get(lessonTO.timeslotId),
        subject: subjectsColl.get(lessonTO.subjectId),
        weekday: weekdaysColl.get(lessonTO.weekdayId)
      });
    }));
    
    return new domain.Schedule({
      id: id,
      name: "Patryk",
      lessons: lessonsColl,
      weekdays: weekdaysColl,
      timeslots: timeslotsColl,
      subjects: subjectsColl
    });

  }

  return {
    createSchedule: createSchedule
  }
});

